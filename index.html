<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Account List</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 30px auto; padding: 20px; line-height:1.6; }
    h1 { text-align:center; }
    #addForm { display:none; margin-top:20px; padding:15px; border:1px solid #ccc; border-radius:10px; background:#f8f8f8; }
    input, button { width:95%; padding:12px; margin:8px 0; font-size:16px; border-radius:8px; border:1px solid #aaa; }
    button { background:#0a7cff; color:white; border:none; cursor:pointer; font-weight:bold; }
    button:hover { background:#005fcc; }
    .nameItem { padding:12px; background:#f2f2f2; margin-bottom:8px; border-radius:8px; cursor:pointer; font-size:18px; transition:0.2s; }
    .nameItem:hover { background:#dbe8ff; color:#0044aa; }
  </style>
</head>
<body>

<h1>Account List</h1>
<button id="showFormBtn">Add an Account</button>

<div id="addForm">
  <h3>Add Account</h3>
  <input type="text" id="name" placeholder="Full Name">
  <!-- <input type="text" id="bank" placeholder="Bank Name"> -->
  <input type="text" id="account" placeholder="Account Number">
  <button id="saveBtn">Save</button>
</div>

<h2>Names</h2>
<div id="namesList"></div>

<script>
const BACKEND_URL = "https://e-accounts-boa.vercel.app/"; 

const namesList = document.getElementById("namesList");
const showFormBtn = document.getElementById("showFormBtn");
const addForm = document.getElementById("addForm");
const saveBtn = document.getElementById("saveBtn");

showFormBtn.addEventListener("click", () => {
  addForm.style.display = addForm.style.display === "block" ? "none" : "block";
});

saveBtn.onclick = async () => {
  const name = document.getElementById("name").value.trim();
  //const bank = document.getElementById("bank").value.trim();
  const account = document.getElementById("account").value.trim();

  if (!name || !bank || !account) { alert("Fill all fields"); return; }

  await fetch(`${BACKEND_URL}/api/addAccount`, {
    method: "POST",
    body: JSON.stringify({ name, bank, account }),
    headers: { "Content-Type": "application/json" }
  });

  document.getElementById("name").value = "";
  //document.getElementById("bank").value = "";
  document.getElementById("account").value = "";
  addForm.style.display = "none";

  loadAccounts();
};

async function loadAccounts() {
  const res = await fetch(`${BACKEND_URL}/api/getAccounts`);
  const data = await res.json();
  namesList.innerHTML = "";

  data.forEach(entry => {
    const item = document.createElement("div");
    item.className = "nameItem";
    item.textContent = entry.name;
    item.onclick = () => {
      navigator.clipboard.writeText(entry.account);
      alert(`Copied account number for ${entry.name}`);
    };
    namesList.appendChild(item);
  });
}

loadAccounts();
setInterval(loadAccounts, 5000);
</script>

</body>
</html>
